!function(){angular.module("main",["ngRoute","ui.bootstrap","ui.bootstrap.contextMenu","nvd3"])}(),function(){angular.module("main").factory("net",function(){return localStorage.ip||(localStorage.ip="192.168.0.73"),localStorage.port||(localStorage.port="8001"),{ip:localStorage.ip,port:localStorage.port,getNetworkParams:function(){return{ip:this.ip,port:this._port}},setNetworkParams:function(e,t){this._ip=e,this.port=t,localStorage.ip=e,localStorage.port=t},setIP:function(e){this.ip=e,localStorage.ip=e},setPort:function(e){this.port=e,localStorage.port=e},address:function(){return"http://"+this.ip+":"+this.port+"/xService/"}}})}(),function(){function e(e,t,a,n,i){this.p=e,this.i=t,this.d=a,this.sp=n,this.en=i}function t(e,t){this.http=e,this.net=t,this.fred=1e3,this.dcred=50,this.fblue=2e3,this.dcblue=50,this.kred=1,this.kblue=1,this.kpmt=[0,0,0,0,0],this.eblue=!0,this.ered=!0,this.setLaserRate=function(e,t){var a="CRDS_CMD/fblue?Rate="+t;e&&(a="CRDS_CMD/fred?Rate="+t),this.http.get(this.net.address()+a)}}function a(e,t){this.http=e,this.net=t,this.spk={vrange:5,voffset:0,f0:1350,df:100,pos:!0,auto:!1,period:360,length:30},this.las={vr:[5,5,5,5,5],voffset:[1,2,3,4,5],f0:[1351,1352,1353,1354,1355],modulation:[!1,!1,!1,!1,!1],enable:[!1,!1,!1,!1,!1]},this.las.setf0=function(e){this.las.f0=e,this.http.get(this.net.address()+"PAS_CMD/UpdateFr?f0="+e.join(","))},this.las.setVr=function(e){this.las.vr=e,this.http.get(this.net.address()+"PAS_CMD/UpdateVrange?Vrange="+e.join(","))},this.las.setVo=function(e){this.las.vr=vr,this.http.get(this.net.address()+"PAS_CMD/UpdateVoffset?Voffset="+e.join(","))},this.las.updateMod=function(e){this.las.moduldation=e;var t=[];for(i=0;i<e.length;i++)t.push(e?1:0)},this.las.updateEnable=function(e){this.las.enable=e},this.spk.updateCtl=function(e){this.spk=e;var t=e.pos?1:0;this.http.get(this.net.address()+"PAS_CMD/SpkSw?SpkSw="+t),this.http.get(this.net.address()+"PAS_CMD/Spk?df="+cvt.pas.spk.df+"&f0="+this.spk.f0),this.http.get(this.net.address()+"PAS_CMD/UpdateSpkVparams?Voffset="+this.spk.voffset+"&Vrange="+this.spk.vrange)},this.spk.updateCycle=function(e,t,a){this.spk.auto=e,this.spk.length=a,this.spk.period=t;var n=e?1:0;this.http.get(this.net.address()+"PAS_CMD/UpdateSpkCycle?Length="+a+"&Period="+t+"&Cycle="+n)}}angular.module("main").factory("cvt",["$http","net",function(n,i){var l={save:!0,ozone:!1,filter_pos:!0,fctl:[]};return l.humidifier={high:new e(.75,1,0,90,!1),med:new e(.75,1,0,80,!1)},l.pas=new a,l.crd=new t(n,i),l.filter_cycle={period:360,length:20,auto:!1},l.checkCvt=function(){promise=n.get(i.address()+"General/cvt").then(function(e,t,a,n){l.crd.fred=e.crd.fred,l.crd.fblue=e.crd.fblue,l.crd.dcred=e.crd.dcred,l.crd.dcblue=e.crd.dcblue,l.crd.kpmt=e.crd.kpmt})},l.flows={},l.flows.updateSP=function(e,t){l.flows[e]=t,n.get(i.address()+"General/DevSP?SP="+t+"&DevID="+e)},l}])}(),function(){angular.module("main").config(["$routeProvider",function(e){e.when("/CRDS",{templateUrl:"views/crds.html"}).when("/PAS",{templateUrl:"views/pas.html"}).when("/O3",{templateUrl:"views/cals/ozone.html"}).when("/",{templateUrl:"views/main.html"}).when("/#",{templateUrl:"views/main.html"}).when("/Flows",{templateUrl:"views/flows.html"}).when("/Temperature",{templateUrl:"views/temperature.html"}).when("/Humidifier",{templateUrl:"views/humidifier.html"}).when("/Common",{templateUrl:"views/common.html"})}])}(),function(){angular.module("main").controller("MainCtlr",["Data","$scope","$interval","cvt",function(e,t,a,n){a(function(){e.getData(),n.checkCvt()},1e3)}])}(),function(){angular.module("main").directive("chart",function(){return{restrict:"E",link:function(e,t,a){var n=null,i={xaxis:{mode:"time"}};e.$watch(a.ngModel,function(e){n?(n.setData(e),n.setupGrid(),n.draw()):(n=$.plot(t,e,i),t.show())})}}})}(),function(){function e(e){var t=new Date(1904,0,1);return t.setSeconds(e),t}function t(){this.ID="",this.Q=0,this.Q0=0,this.P=0,this.T=0,this.Qsp=0}function a(){this.f0=[],this.IA=[],this.Q=[],this.p=[],this.abs=[],this.micf=[],this.mict=[],this.pd=[]}function n(){this.tau=[],this.tau0=[],this.taucorr=[],this.tau0corr=[],this.ext=[],this.extcorr=[],this.stdvTau=[],this.etau=[],this.max=[],this.rd=[]}function l(e,t,n){var i=t.time[0];for(var l in e.PAS.CellData)t.pas.cell.length-1<l&&t.pas.cell.push(new a),n&&(t.pas.cell[l].f0.pop(),t.pas.cell[l].IA.pop(),t.pas.cell[l].Q.pop(),t.pas.cell[l].p.pop(),t.pas.cell[l].abs.pop()),t.pas.cell[l].f0.unshift({x:i,y:e.PAS.CellData[l].derived.f0}),t.pas.cell[l].IA.unshift({x:i,y:e.PAS.CellData[l].derived.IA}),t.pas.cell[l].Q.unshift({x:i,y:e.PAS.CellData[l].derived.Q}),t.pas.cell[l].p.unshift({x:i,y:e.PAS.CellData[l].derived.noiseLim}),t.pas.cell[l].abs.unshift({x:i,y:e.PAS.CellData[l].derived.ext}),t.pas.cell[l].micf=e.PAS.CellData[l].MicFreq.Y,t.pas.cell[l].mict=e.PAS.CellData[l].MicTime.Y,t.pas.cell[l].pd=e.PAS.CellData[l].PhotoDiode.Y;return t.pas.drive=e.PAS.Drive,t}function s(e,t,a){var i=t.time[0];for(var l in e.CellData)t.crd.cell.length-1<l&&t.crd.cell.push(new n),a&&(t.crd.cell[l].tau.pop(),t.crd.cell[l].tau0.pop(),t.crd.cell[l].taucorr.pop(),t.crd.cell[l].tau0corr.pop(),t.crd.cell[l].ext.pop(),t.crd.cell[l].extcorr.pop(),t.crd.cell[l].stdvTau.pop(),t.crd.cell[l].etau.pop(),t.crd.cell[l].max.pop()),t.crd.cell[l].tau.unshift({x:i,y:e.CellData[l].extParam.Tau}),t.crd.cell[l].tau0corr.unshift({x:i,y:e.CellData[l].extParam.Tau0cor}),t.crd.cell[l].taucorr.unshift({x:i,y:e.CellData[l].extParam.taucorr}),t.crd.cell[l].tau0.unshift({x:i,y:e.CellData[l].extParam.Tau0}),t.crd.cell[l].ext.unshift({x:i,y:e.CellData[l].extParam.ext}),t.crd.cell[l].extcorr.unshift({x:i,y:e.CellData[l].extParam.extCorr}),t.crd.cell[l].stdvTau.unshift({x:i,y:e.CellData[l].extParam.stdevTau}),t.crd.cell[l].etau.unshift({x:i,y:e.CellData[l].extParam.eTau}),t.crd.cell[l].max.unshift({x:i,y:e.CellData[l].extParam.max});return t}angular.module("main").factory("Data",["$rootScope","$http","$log","net","cvt",function(r,o,c,u,d){var p=["TestAlicat"],f=["pDryBlue"],h=["vDryRed","vDryBlue"],m={cTime:null,tObj:new Date,filter:!0,save:!0,o3cal:!1,Cabin:!1,time:[],msg:[]},v=300,g=!1;m.pas={},m.pas.cell=[new a],m.pas.drive=!0,m.popMsgQueue=function(){var e=m.msg.slice();return m.msg=[],e},m.flowData=[new t],m.crd={},m.crd.cell=[new n];var D=[];return m.getData=function(){promise=o.get(u.address()+"General/Data").success(function(t,a,n,o){for(i=0;i<p.length;i++)p[i]in t&&(m[p[i]]=t[p[i]]);for(i=0;i<f.length;i++)f[i]in t&&(m[f[i]]=t[f[i]]);for(i=0;i<h.length;i++)h[i]in t&&(m[h[i]]=t[h[i]]);if(m.time.length-1>=v&&(m.time.pop(),g=!0),m.tObj=e(Number(t.Time)),t.PAS.drive){for(D=[],i=0;i<t.PAS.CellData.length;i++)D.push(t.PAS.CellData[i]);d.pas.las.setf0(D)}var c=m.tObj.getTime();m.time.unshift(c),m=l(t,m,g),m=s(t,m,g),m.Cabin=t.Cabin,r.$broadcast("dataAvailable"),t.Msg.length>0&&(m.msg.length>0?m.msg.concat(t.Msg):m.msg=t.Msg.slice(),r.$broadcast("msgAvailable"))}).error(function(){r.$broadcast("dataNotAvailable"),c.debug(status)})},m}])}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/Messages/msg.html"}}angular.module("main").directive("msg",e)}(),function(){angular.module("main").controller("msgCtlr",["Data","$scope",function(e,t){t.msgs=[],t.error_code=[],t.num_codes=[0,0,0],t.$on("msgAvailable",function(){var a=e.popMsgQueue();for(i=0;i<a.length;i++)t.msgs.push(a[i]),a[i].search("ERROR")>0?(t.error_code.push(2),t.num_codes[2]+=1):a[i].search("WARNING")>0?(t.error_code.push(1),t.num_codes[1]+=1):(t.error_code.push(0),t.num_codes[0]+=1);t.clrMsgs=function(){t.num_codes=[0,0,0],t.msgs=[]}})}])}(),function(){angular.module("main").controller("Sidebar",["$scope","$http","Data","net",function(e,t,a,n){e.save=1,e.filter=!0,e.ip=n.ip,e.port=n.port,e.time="Not connected",e.connected=!1,e.o3On=!1,e.cabin=!1,e.pumpBlocked=!1,e.impBlocked=!1,e.interlock=!1,e.changeIP=function(){n.setIP(e.ip)},e.changePort=function(){n.setPort(e.port)},e.time="Not Connected",e.connected=!1,e.$on("dataAvailable",function(){e.time=a.tObj.toLocaleTimeString("en-US",{hour12:!1}),e.filter=a.filter,e.cabin=a.Cabin,e.connected=!0}),e.$on("dataNotAvailable",function(){e.connected=!1}),e.saveData=function(){e.save=!e.save;var a=e.save?1:0;t.get(n.address()+"General/Save?save="+a.toString())},e.setFilter=function(){e.filter=!e.filter;var a=e.filter?1:0;t.get(n.address()+"General/UpdateFilter?State="+a)},e.setCabin=function(){e.cabin=!e.cabin;var a=e.cabin?1:0;t.get(n.address()+"General/Cabin?Cabin="+a)},e.stop=function(){t.get(n.address()+"General/Stop")}}])}(),function(){angular.module("main").controller("startCal",["$scope","$http","net","cvt",function(e,t,a,n){e.cal=n.ozone,e.startCalibration=function(){e.cal=!e.cal;var i=e.cal?1:0;n.ozone=e.cal,t.get(a.address()+"General/ozone?start="+i.toString())}}])}(),function(){angular.module("main").factory("tableService",["$rootScope",function(e){var t={curTab:"",getTab:function(){return this.curTab},setTab:function(t){this.curTab=t,e.$broadcast("handleBroadcast")}};return t}])}(),function(){angular.module("main").controller("O3Table",["$scope","tableService",function(e,t){e.table_vals=[{id:"Wait",step:"Wait",descr:"Set a wait time in the ozone cal in seconds"},{id:"Filter",step:"Filter",descr:"Boolean that sets the filter state."},{id:"Speaker",step:"Speaker",descr:"Boolean that sets the speaker state."},{id:"O2 Valve",step:"O2 Valve",descr:"Boolean that sets the O2 valve position."},{id:"O3 Valve",step:"O3 Valve",descr:"Boolean that sets the O3 valve state."},{id:"O3 Generator",step:"O3 Generator",descr:"Boolean that sets the O3 generator state."},{id:"QO2",step:"O2 Flow Rate",descr:"Numeric to set the oxygen flow rate"}],e.clickRow=function(e){t.setTab(e.id.toString())}}])}(),function(){angular.module("main").factory("SaveData",function(){var e={data:[],setData:function(e){this.data=e},getData:function(){return this.data}};return e})}(),function(){angular.module("main").controller("Save",["$scope","SaveData","$http","net",function(e,t,a,n){e.cal_file="default",e.save=function(){var i='<?xml version="1.0" encoding="utf-8"?>\r\n<OZONE>\r\n';t.getData().forEach(function(e){i+="	<"+e.id+">"+e.val+"<\\"+e.id+">\r\n"}),i+="<\\OZONE>",a({method:"POST",url:n.address()+"/xService/Calibration/saveCalFile?file_name="+e.cal_file+".xml",data:i,headers:{"Content-Type":"application/x-www-form-urlencoded"}})}}])}(),function(){angular.module("main").controller("InputTable",["$scope","tableService","SaveData",function(e,t,a){e.data=[],e.$on("handleBroadcast",function(){var n=t.getTab(),i="";switch(n){case"O3 Valve":case"O2 Valve":case"O3 Generator":case"Filter":i="FALSE";break;case"Wait":case"Speaker":i="20";break;case"QO2":i="100"}e.data.push({id:n,val:i}),a.setData(e.data)})}])}(),function(){angular.module("main").controller("filter",["$scope","net","$http","cvt",function(e,t,a,n){e.cycle=n.filter_cycle,e.position=n.filter_pos,e.updateCycle=function(){var i=e.cycle.auto?1:0;a.get(t.address()+"General/FilterCycle?Length="+e.cycle.length+"&Period="+e.cycle.period+"&auto="+i),n.filter_cycle={period:e.cycle.period,length:e.cycle.length,auto:e.cycle.auto}},e.updateFilter=function(){var i=e.position?1:0;a.get(t.address()+"General/UpdateFilter?State="+i),n.pos=e.position},e.updateAuto=function(){e.cycle.auto=!e.cycle.auto,e.updateCycle()}}])}(),function(){angular.module("main").controller("power",["$scope","cvt",function(e,t){e.power={TEC:!1,Laser:!1,Pump:!1,"O3 Gen":!1,Denuder:!1},e.toggle=function(t){e.power[t]=!e.power[t];var a=0,n=0,i=0;for(var l in e.power)e.power.hasOwnProperty(l)&&(i=e.power[l]?1:0,n+=Math.pow(2,a)*i,a+=1);alert(n)}}])}(),function(){angular.module("main").controller("crd",["$scope","cvt","Data",function(e,t,a){var n=function(e,t,a,n,i){this.rate=e,this.DC=t,this.k=a,this.en=n,this.id=i};e.setRate=function(e,a){t.crd.setLaserRate(e,a)},e.laser_ctl=[new n(t.crd.fblue,t.crd.dcblue,t.crd.kblue,t.crd.eblue,"Blue Laser"),new n(t.crd.fred,t.crd.dcred,t.crd.kred,t.crd.ered,"Red Laser")],e.pmt=t.crd.kpmt,e.data=a.crd,e.setEnable=function(a){e.laser_ctl[a].en=!e.laser_ctl[a].en;var n=e.laser_ctl[a].en;switch(a){case 0:t.crd.eblue=n;break;case 1:t.crd.ered=n}},e.tauData=[{values:[],key:"&tau;"},{values:[],key:"&tau<sub>0</sub>"},{values:[],key:"&tau<sub>0</sub>"},{values:[],key:"&sigma;<sub>&tau;</sub>"}],e.options={chart:{type:"lineChart",height:300,margin:{top:20,right:40,bottom:60,left:75},x:function(e){return e.x},y:function(e){return e.y},useInteractiveGuideline:!0,yAxis:{tickFormat:function(e){return d3.format("0.01f")(e)},axisLabel:"Testing"},xAxis:{tickFormat:function(e){return d3.time.format("%X")(new Date(e))},rotateLabels:-45},transitionDuration:500,showXAxis:!0,showYAxis:!0}},e.$on("dataAvailable",function(){e.data=a.crd,e.tauData[0].values=e.data.cell[0].max,e.tauData[1].values=e.data.cell[0].tau0,e.tauData[2].values=e.data.cell[0].stdvTau})}])}(),function(){angular.module("main").controller("pas",["$scope","net","$http","cvt","Data","$log",function(e,t,a,n,l,s){e.data=l.pas;var r=0;e.menuOptions=[["IA",function(t){r=0,e.options.chart.yAxis.axisLabel="IA"}],["f0",function(t){r=1,e.options.chart.yAxis.axisLabel="f0 (Hz)"}],["Q",function(t){r=2,e.options.chart.yAxis.axisLabel="Q"}],["p",function(t){r=3,e.options.chart.yAxis.axisLabel="p"}],["abs",function(t){r=4,e.options.chart.yAxis.axisLabel="Absorption (Mm-1)"}]],e.plotData=[{values:[],key:"Cell 1"},{values:[],key:"Cell 2"},{values:[],key:"Cell 3"},{values:[],key:"Cell 4"},{values:[],key:"Cell 5"}],e.options={chart:{type:"lineChart",height:300,margin:{top:20,right:10,bottom:60,left:75},x:function(e){return e.x},y:function(e){return e.y},useInteractiveGuideline:!0,yAxis:{tickFormat:function(e){return d3.format("0.01f")(e)},axisLabel:"Testing"},xAxis:{tickFormat:function(e){return d3.time.format("%X")(new Date(e))},rotateLabels:-45},transitionDuration:500,showXAxis:!0,showYAxis:!0}},e.$on("dataAvailable",function(){for(e.data=l.pas,i=0;i<5;i++)switch(r){case 0:e.plotData[i].values=e.data.cell[i].IA;break;case 1:e.plotData[i].values=e.data.cell[i].f0;break;case 2:e.plotData[i].values=e.data.cell[i].Q;break;case 3:e.plotData[i].values=e.data.cell[i].p;break;case 4:e.plotData[i].values=e.data.cell[i].abs}})}])}(),function(){angular.module("main").controller("pasSpk",["$scope","cvt","Data",function(e,t,a){var n=10,i=5;e.speaker=t.pas.spk;var l={high:3e3,low:500};e.cycle={period:t.pas.spk.period,length:t.pas.spk.length,auto:t.pas.spk.auto},e.setPos=function(){e.speaker.pos=!e.speaker.pos,t.pas.spk.updateCtl(e.speaker)},e.updateSpkV=function(){e.speaker.vrange>n?e.speaker.vrange=n:e.speaker.vrange<0&&(e.speaker.vrange=0),e.speaker.voffset>i?e.speaker.voffset=i:e.speaker.voffset<0&&(e.speaker.voffset=0),t.pas.spk.updateCtl(e.speaker)},e.updateSpkF=function(){e.speaker.f0>l.high?e.speaker.f0=l.high:e.speaker.f0<l.low&&(e.speaker.f0=l.low),t.pas.spk.updateCtl(e.speaker)},e.updateCycle=function(){t.pas.spk.updateCycle(e.cycle.auto,e.cycle.period,e.cycle.length)},e.updateAuto=function(){e.cycle.auto=!e.cycle.auto,e.updateCycle()}}])}(),function(){function e(e,t,a,n,i){this.Vrange=e,this.Voffset=t,this.f0=a,this.modulation=n,this.lasEn=!1}angular.module("main").controller("pasLas",["$scope","cvt","Data",function(t,a,n){for(t.lasCtl=[],i=0;i<a.pas.las.vr.length;i++)t.lasCtl.push(new e(a.pas.las.vr[i],a.pas.las.voffset[i],a.pas.las.f0[i],a.pas.las.modulation[i],a.pas.las.enable[i]));t.$on("dataAvailable",function(){if(n.pas.drive)for(i=0;i<n.pas.cell.length;i++)t.lasCtl[i].f0=t.data.cell[i].f0[0].y}),t.updateMod=function(e){t.lasCtl[e].modulation=!t.lasCtl[e].modulation;var n=[];for(j=0;j<t.lasCtl.length;j++)n.push(t.lasCtl[j].modulation);a.pas.las.updateMod(n)},t.updateVr=function(){var e=[];for(i=0;i<t.lasCtl.length;i++)e.push(t.lasCtl[i].Vrange);a.pas.las.setVr(e)},t.updateVo=function(){var e=[];for(i=0;i<t.lasCtl.length;i++)e.push(t.lasCtl[i].Voffset);a.pas.las.setVo(e)},t.updatef0=function(){var e=[];for(i=0;i<t.lasCtl.length;i++)e.push(t.lasCtl[i].f0);a.pas.las.setf0(e)},t.updateEnable=function(e){t.lasCtl[e].lasEn=!t.lasCtl[e].lasEn;var n=[];for(e=0;e<t.lasCtl.length;e++)n.push(t.lasCtl[e].lasEn);a.pas.las.updateEnable(n)}}])}(),function(){angular.module("main").controller("flowCtlr",["$scope","Data","cvt",function(e,t,a){function n(){this.P=0,this.T=0,this.Q=0,this.Q0=0,this.Q=0}function i(t,a,i,s,r){this.label=t,this.ID=a,this.type=i,this.isController=s,this.data=new n,this.sp=r,this.index=-1,s&&(e.setpoints.push(r),l+=1,this.index=l)}var l=-1;e.setpoints=[],e.Devices=[new i("Dry Red","TestAlicat","mflow",!0,0),new i("Dry Blue","dryBlue","mflow",!1,0),new i("Denuded Blue","deBlue","mflow",!1,0),new i("Denuded Red","deRed","mflow",!0,0),new i("PAS Green","pGreen","mflow",!1,0),new i("CRD High Humidified","crdHighHum","mflow",!1,0),new i("CRD Low Humidified","crdLowHum","mflow",!1,0),new i("Mirror Purge Flow","crdMirror","mflow",!1,0),new i("Pressure Controller","pCtl","pressure",!1,0),new i("O3 Bypass","o3Bypass","mflow",!0,0)],e.updateSP=function(e){a.flows.updateSP(e.ID,e.sp)},e.$on("dataAvailable",function(){for(j=0;j<e.Devices.length;j++)e.Devices[j].ID in t&&(e.Devices[j].P=t[e.Devices[j].ID].P,e.Devices[j].T=t[e.Devices[j].ID].T,e.Devices[j].Q=t[e.Devices[j].ID].Q,e.Devices[j].Q0=t[e.Devices[j].ID].Q0,e.Devices[j].Qsp=t[e.Devices[j].ID].Qsp)})}])}(),function(){angular.module("main").controller("humidifier",["$scope","cvt","Data",function(e,t,a){e.high=t.humidifier.high,e.med=t.humidifier.med,e.updateMedEn=function(){e.med.en=!e.med.en,t.humidifier.med=e.med.en},e.updateHighEn=function(){e.high.en=!e.high.en,t.humidifier.high=e.high.en}}])}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/msg/msg.html"}}angular.module("main").directive("msg",e)}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/sidebar/side.html"}}angular.module("main").directive("sidebar",e)}(),function(){function e(){return{restrict:"E",scope:{},templateUrl:"app/navigation/navi.html"}}angular.module("main").directive("navi",e)}(),angular.module("ui.bootstrap.contextMenu",[]).directive("contextMenu",["$parse",function(e){var t=function(e,t,a,n){if(!i)var i=angular.element;i(t.currentTarget).addClass("context");var l=i("<div>");l.addClass("dropdown clearfix");var s=i("<ul>");s.addClass("dropdown-menu"),s.attr({role:"menu"}),s.css({display:"block",position:"absolute",left:t.pageX+"px",top:t.pageY+"px"}),angular.forEach(a,function(a,r){var o=i("<li>");if(null===a)o.addClass("divider");else{var c=i("<a>");c.attr({tabindex:"-1",href:"#"});var u="string"==typeof a[0]?a[0]:a[0].call(e,e,t,n);c.text(u),o.append(c);var d=angular.isDefined(a[2])?a[2].call(e,e,t,u,n):!0;d?o.on("click",function(s){s.preventDefault(),e.$apply(function(){i(t.currentTarget).removeClass("context"),l.remove(),a[1].call(e,e,t,n)})}):(o.on("click",function(e){e.preventDefault()}),o.addClass("disabled"))}s.append(o)}),l.append(s);var r=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight);l.css({width:"100%",height:r+"px",position:"absolute",top:0,left:0,zIndex:9999}),i(document).find("body").append(l),l.on("mousedown",function(e){i(e.target).hasClass("dropdown")&&(i(t.currentTarget).removeClass("context"),l.remove())}).on("contextmenu",function(e){i(e.currentTarget).removeClass("context"),e.preventDefault(),l.remove()})};return function(e,a,n){a.on("contextmenu",function(a){a.stopPropagation(),e.$apply(function(){a.preventDefault();var i=e.$eval(n.contextMenu),l=e.$eval(n.model);if(!(i instanceof Array))throw'"'+n.contextMenu+'" not an array';0!==i.length&&t(e,a,i,l)})})}}]);